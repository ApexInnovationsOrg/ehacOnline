


var pipeURL="";var pipeURLLoc=window.parent.location;var pipeHash=new String(pipeURLLoc.hash);var strPipeURL=pipeHash.substr(0,pipeHash.toLowerCase().lastIndexOf("scormdriver"));strPipeURL=strPipeURL.substr(1,strPipeURL.length)+"scormdriverxd/scormpipexd.html";pipeURL=strPipeURL;var contentPath="";var frmPipeFrame=parent.frames["pipeFrame"];numberPipeMessages=0;var lastId="";function checkForMessages(){if(location.hash!=lastId){lastId=location.hash;numberPipeMessages++;var loc=new String(location.hash);var aryMessages=loc.split("#");var cmdSD;if(aryMessages[2]!=null)
{cmdSD=aryMessages[2].substring(aryMessages[2].indexOf("_")+1,aryMessages[2].length);}else{cmdSD=aryMessages[1].substring(aryMessages[1].indexOf("_")+1,aryMessages[1].length);}
var arrcmdSD=cmdSD.split(":");switch(arrcmdSD[0]){case"SuccessStatus":if(new Number(arrcmdSD[1])==1)
{}else{alert("Could Not Save Data To LMS");}
break;case"ReturningScore":return new Number(arrcmdSD[1]);break;case"ReturningPassingScore":case"ReturningAudioVolumePreference":case"ReturningPreviouslyAccumulatedTime":case"ReturningSessionAccumulatedTime":case"ReturningMaxTimeAllowed":case"ReturningEntryMode":case"ReturningLessonMode":case"ReturningSpeedPreference":alert("returning number: "+new Number(arrcmdSD[1]));return new Number(arrcmdSD[1]);break;case"ReturningIsLoaded":case"ReturningIsLmsPresent":alert("returning boolean: "+new Boolean(arrcmdSD[1]));return new Boolean(arrcmdSD[1]);break;case"ReturningBookmark":case"ReturningDataChunk":case"ReturningStatus":case"ReturningStudentID":case"ReturningStudentName":case"ReturningLastError":case"ReturningLastLMSErrorCode":case"ReturningLastErrorDesc":case"ReturningLaunchData":case"ReturningLMSComments":case"ReturningSpeedPreference":case"ReturningLanguagePreference":case"ReturningTextPreference":case"ReturningTakingForCredit":case"ReturningAudioPlayPreference":case"ReturningObjectiveStatus":case"ReturningObjectiveDescription":case"ReturningObjectiveScore":alert("returning string: "+arrcmdSD[1]);return arrcmdSD[1];break;case"ReturningComments":alert("returning array: "+arrcmdSD[1]);return arrcmdSD[1];break;}}}
SCORMDriver={setLastMessage:function(strMessage){this.LastMessage=strMessage;},getLastMessage:function(){return this.LastMessage;},sendPipeMessageToLMS:function(strMessage){this.LastMessage=strMessage;frmPipeFrame.location=pipeURL+strMessage;},SetFailedWithScore:function(intScore,intMaxScore,intMinScore){this.sendPipeMessageToLMS("#pipeMessage_SetFailedWithScore:"+intScore+":"+intMaxScore+":"+intMinScore);},SetPassedWithScore:function(intScore,intMaxScore,intMinScore){this.sendPipeMessageToLMS("#pipeMessage_SetPassedWithScore:"+intScore+":"+intMaxScore+":"+intMinScore);},SetReachedEnd:function(){this.sendPipeMessageToLMS("#pipeMessage_SetReachedEnd");},ConcedeControl:function(){this.sendPipeMessageToLMS("#pipeMessage_ConcedeControl");},SetScore:function(intScore,intMaxScore,intMinScore){this.sendPipeMessageToLMS("#pipeMessage_SetScore:"+intScore+":"+intMaxScore+":"+intMinScore);},ResetStatus:function(){this.sendPipeMessageToLMS("#pipeMessage_ResetStatus");},CommitData:function(){this.sendPipeMessageToLMS("#pipeMessage_CommitData");},SetPassed:function(){this.sendPipeMessageToLMS("#pipeMessage_SetPassed");},SetFailed:function(){this.sendPipeMessageToLMS("#pipeMessage_SetFailed");},PauseTimeTracking:function(){this.sendPipeMessageToLMS("#pipeMessage_PauseTimeTracking");},ResumeTimeTracking:function(){this.sendPipeMessageToLMS("#pipeMessage_ResumeTimeTracking");},SetObjectiveScore:function(strObjectiveID,intScore,intMaxScore,intMinScore){this.sendPipeMessageToLMS("#pipeMessage_SetObjectiveScore:"+strObjectiveID+":"+intScore+":"+intMaxScore+":"+intMinScore);},SetObjectiveStatus:function(strObjectiveID,Lesson_Status){this.sendPipeMessageToLMS("#pipeMessage_SetObjectiveStatus:"+strObjectiveID+":"+Lesson_Status);},SetObjectiveDescription:function(strObjectiveID,strObjectiveDescription){this.sendPipeMessageToLMS("#pipeMessage_SetObjectiveStatus:"+strObjectiveID+":"+strObjectiveDescription);},SetSessionTime:function(intMilliseconds){this.sendPipeMessageToLMS("#pipeMessage_SetSessionTime:"+intMilliseconds);},SetAudioPreference:function(PlayPreference,intPercentOfMaxVolume){this.sendPipeMessageToLMS("#pipeMessage_SetAudioPreference:"+PlayPreference+":"+intPercentOfMaxVolume);},SetLanguagePreference:function(strLanguage){this.sendPipeMessageToLMS("#pipeMessage_SetLanguagePreference:"+strLanguage);},SetSpeedPreference:function(intPercentOfMax){this.sendPipeMessageToLMS("#pipeMessage_SetSpeedPreference:"+intPercentOfMax);},SetTextPreference:function(intPreference){this.sendPipeMessageToLMS("#pipeMessage_SetTextPreference:"+intPreference);},SetBookmark:function(strBookmark){this.sendPipeMessageToLMS("#pipeMessage_SetBookmark:"+strBookmark);},SetDataChunk:function(strData){this.sendPipeMessageToLMS("#pipeMessage_SetDataChunk:"+strData);},WriteComment:function(strComment){this.sendPipeMessageToLMS("#pipeMessage_WriteComment:"+strComment);},RecordTrueFalseInteraction:function(strID,blnResponse,blnCorrect,blnCorrectResponse,strDescription,intWeighting,intLatency,strLearningObjectiveID){this.sendPipeMessageToLMS("#pipeMessage_RecordTrueFalseInteraction:"+strID+":"+blnResponse+":"+blnCorrect+":"+blnCorrectResponse+":"+strDescription+":"+intWeighting+":"+intLatency+":"+strLearningObjectiveID);},RecordMultipleChoiceInteraction:function(strID,response,blnCorrect,correctResponse,strDescription,intWeighting,intLatency,strLearningObjectiveID){this.sendPipeMessageToLMS("#pipeMessage_RecordMultipleChoiceInteraction:"+strID+":"+response+":"+blnCorrect+":"+correctResponse+":"+strDescription+":"+intWeighting+":"+intLatency+":"+strLearningObjectiveID);},RecordFillInInteraction:function(strID,strResponse,blnCorrect,strCorrectResponse,strDescription,intWeighting,intLatency,strLearningObjectiveID){this.sendPipeMessageToLMS("#pipeMessage_RecordFillInInteraction:"+strID+":"+strResponse+":"+blnCorrect+":"+strCorrectResponse+":"+strDescription+":"+intWeighting+":"+intLatency+":"+strLearningObjectiveID);},RecordMatchingInteraction:function(strID,response,blnCorrect,correctResponse,strDescription,intWeighting,intLatency,strLearningObjectiveID){this.sendPipeMessageToLMS("#pipeMessage_RecordMatchingInteraction:"+strID+":"+response+":"+blnCorrect+":"+correctResponse+":"+strDescription+":"+intWeighting+":"+intLatency+":"+strLearningObjectiveID);},RecordPerformanceInteraction:function(strID,strResponse,blnCorrect,strCorrectResponse,strDescription,intWeighting,intLatency,strLearningObjectiveID){this.sendPipeMessageToLMS("#pipeMessage_RecordPerformanceInteraction:"+strID+":"+blnResponse+":"+blnCorrect+":"+strCorrectResponse+":"+strDescription+":"+intWeighting+":"+intLatency+":"+strLearningObjectiveID);},RecordSequencingInteraction:function(strID,response,blnCorrect,correctResponse,strDescription,intWeighting,intLatency,strLearningObjectiveID){this.sendPipeMessageToLMS("#pipeMessage_RecordSequencingInteraction:"+strID+":"+response+":"+blnCorrect+":"+correctResponse+":"+strDescription+":"+intWeighting+":"+intLatency+":"+strLearningObjectiveID);},RecordLikeInteraction:function(strID,response,blnCorrect,correctResponse,strDescription,intWeighting,intLatency,strLearningObjectiveID){this.sendPipeMessageToLMS("#pipeMessage_RecordLikeInteraction:"+strID+":"+response+":"+blnCorrect+":"+correctResponse+":"+strDescription+":"+intWeighting+":"+intLatency+":"+strLearningObjectiveID);},RecordNumericInteraction:function(strID,strResponse,blnCorrect,strCorrectResponse,strDescription,intWeighting,intLatency,strLearningObjectiveID){this.sendPipeMessageToLMS("#pipeMessage_RecordNumericInteraction:"+strID+":"+strResponse+":"+blnCorrect+":"+strCorrectResponse+":"+strDescription+":"+intWeighting+":"+intLatency+":"+strLearningObjectiveID);},GetScore:function(){this.sendPipeMessageToLMS("#pipeMessage_GetScore");},GetPassingScore:function(){this.sendPipeMessageToLMS("#pipeMessage_GetPassingScore");},GetAudioVolumePreference:function(){this.sendPipeMessageToLMS("#pipeMessage_GetAudioVolumePreference");},GetPreviouslyAccumulatedTime:function(){this.sendPipeMessageToLMS("#pipeMessage_GetPreviouslyAccumulatedTime");},GetSessionAccumulatedTime:function(){this.sendPipeMessageToLMS("#pipeMessage_GetSessionAccumulatedTime");},GetMaxTimeAllowed:function(){this.sendPipeMessageToLMS("#pipeMessage_GetMaxTimeAllowed");},GetEntryMode:function(){this.sendPipeMessageToLMS("#pipeMessage_GetEntryMode");},GetLessonMode:function(){this.sendPipeMessageToLMS("#pipeMessage_GetLessonMode");},GetSpeedPreference:function(){this.sendPipeMessageToLMS("#pipeMessage_GetSpeedPreference");},IsLoaded:function(){this.sendPipeMessageToLMS("#pipeMessage_IsLoaded");},IsLmsPresent:function(){this.sendPipeMessageToLMS("#pipeMessage_IsLmsPresent");},GetBookmark:function(){this.sendPipeMessageToLMS("#pipeMessage_GetBookmark");},GetDataChunk:function(){this.sendPipeMessageToLMS("#pipeMessage_GetDataChunk");},GetStatus:function(){this.sendPipeMessageToLMS("#pipeMessage_GetStatus");},GetStudentID:function(){this.sendPipeMessageToLMS("#pipeMessage_GetStudentID");},GetStudentName:function(){this.sendPipeMessageToLMS("#pipeMessage_GetStudentName");},GetLastError:function(){this.sendPipeMessageToLMS("#pipeMessage_GetLastError");},GetLastLMSErrorCode:function(){this.sendPipeMessageToLMS("#pipeMessage_GetLastLMSErrorCode");},GetLastErrorDesc:function(){this.sendPipeMessageToLMS("#pipeMessage_GetLastErrorDesc");},GetLaunchData:function(){this.sendPipeMessageToLMS("#pipeMessage_GetLaunchData");},GetLMSComments:function(){this.sendPipeMessageToLMS("#pipeMessage_GetLMSComments");},GetSpeedPreference:function(){this.sendPipeMessageToLMS("#pipeMessage_GetSpeedPreference");},GetLanguagePreference:function(){this.sendPipeMessageToLMS("#pipeMessage_GetLanguagePreference");},GetTextPreference:function(){this.sendPipeMessageToLMS("#pipeMessage_GetTextPreference");},GetTakingForCredit:function(){this.sendPipeMessageToLMS("#pipeMessage_GetTakingForCredit");},GetAudioPlayPreference:function(){this.sendPipeMessageToLMS("#pipeMessage_GetAudioPlayPreference");},GetObjectiveStatus:function(strObjectiveID){this.sendPipeMessageToLMS("#pipeMessage_GetObjectiveStatus");},GetObjectiveDescription:function(strObjectiveID){this.sendPipeMessageToLMS("#pipeMessage_GetObjectiveDescription");},GetObjectiveScore:function(strObjectiveID){this.sendPipeMessageToLMS("#pipeMessage_GetObjectiveScore");},GetComments:function(){this.sendPipeMessageToLMS("#pipeMessage_GetComments");}}
var SD=SCORMDriver;setInterval(checkForMessages,200);